= API Gateway capabilities (Mule 4)

Mule Runtime includes API Gateway capabilities that allow you to add an aspect to your Mule application. These aspects can, for example, add a security layer to your Mule application, or enrich an incoming/outgoing message, among other usages. +
This allows any person to add complex capabilities to an API without the need to write any code.

Mule Runtime adds an abstract layer over backend APIs and services, so you can manage this layer from API Manager. Consumer applications invoke your services, API Gateway enforces the specified runtime policies and collects usage data (ie analytics information) sending it to a specified system for it to be processed. API Gateway acts as a dedicated orchestration layer for all your backend APIs to separate orchestration from implementation concerns. +
API Gateway leverages the governance capabilities of API Manager, so that you can apply throttling, security, caching, logging and other policies to your APIs

image:APIgateway.png[APIgateway,height=307,width=700]

To configure Mule 4 Runtime, see link:/mule4-user-guide/v/4.1/runtime-installation-task[Downloading and Starting Mule] and link:/mule4-user-guide/v/4.1/installing-an-enterprise-license[Installing an Enterprise License].

= Using API Gateway capabilities on an API

If you’d like to apply policies and generate analytics info, you must use either:

* An API defined in a Mule application .
* A Mule application that will proxy your existing backend implementation.

== Key Concepts

=== API

An API is an abstraction of a set of components, one that encapsulates the complexity and presents an easy and reusable way of accessing assets. Policies are applied to these APIs when they are tracked by an Autodiscovery element in the Mule Application and the API Pointcut matches.

=== HTTP API

A HTTP(s) API is the one created using a HTTP Exchange asset. It assumes that the associated Mule Application to be tracked has defined an implementation endpoint which is a simple HTTP(s) listener.

*Usual usage*: REST based APIs.

=== RAML API

A RAML API is the one created using a RAML/OAS Exchange asset. It assumes that the associated Mule Application to be tracked has defined an implementation endpoint which is a simple HTTP(s) listener with a RAML/OAS router. In order to have such an asset in Exchange, you may design your API using API Designer, and then export it to Exchange.

*Usual usage*: RAML/OAS based APIs.

=== WSDL API

A WSDL API  is the one created using a WSDL Exchange asset. It assumes that the associated Mule Application to be tracked has defined an implementation endpoint which is a simple HTTP(s) listener with a WSDL router.

*Usual usage*: WSDL based APIs.

=== API Proxy

Also known as Autogenerated Proxy, a Mule Application that improves the ease of use of API Gateway capabilities.

*Usual usage*: When you’d like to leverage API Gateway capabilities and your API backend is not a Mule based one, or it is, but it is a closed code and you are unable to define the corresponding autodiscovery element.

When you configure your API to be a Proxy Endpoint instead of Basic Endpoint, the platform offers you the possibility to download a pre-configured Mule Application that when deployed in a runtime the API will be automatically tracked, if and only if, the runtime is configured with the correct API Platform credentials. No need to know anything about how to create a Mule Application, just deploy the application to a correctly configured runtime.

[NOTE]
Anypoint Platform offers you the possibility to deploy the proxy directly to Cloudhub or using the Mule agent, through the use of Runtime Manager.

If you would like to use HTTPs instead of HTTP, you may import the autogenerated proxy into Mule Studio, specify the certificates to be used, and deploy the application to Cloudhub or a runtime instance, either from Mule Studio itself, or manually.

The proxies that can be downloaded from API Platform are a convenient tool to speed your Application Network development. Having said that, you are not restricted to using an autogenerated proxy. Any Mule Application, provided with a correctly configured Auto-Discovery, can be used to leverage API Gateway capabilities.

=== Policies

Policies are the tool to apply orthogonal behaviour to a whole API, or a resource of it. Incoming/Outgoing messages can be decorated, filtered, controlled and the API secured. API Gateway provides not only out of the box policies (OOTB Policies), but an engine to create your own Custom Policies.

=== Analytics

When the API Gateway is connected to API Platform, API usage can be monitored in the form of API Analytics. API Gateway will report the API usage, from a policy perspective, including the detected policy violations.

=== API Autodiscovery

API Autodiscovery is the mechanism by which an API representing a HTTP resource can be managed from API Manager. When this element is defined in a Mule Application, the API Gateway can keep up to date the selected configuration in API Manager.

Learn more link:/api-manager/v/2.x/api-auto-discovery-new-concept[About API Autodiscovery].

For Autodiscovery to work, the Mule Runtime (acting as gateway) requires API Platform credentials.

=== Pointcut

ointcuts are the way in which an API Gateway links an API with an HTTP Resource. In Mule 4, these elements are invisible to the users, and are only managed internally by the API Gateway, and API Platform.
The pointcut granularity can be selected (for most policies) when configuring a policy. Two available options are listed:

* API Pointcut

The API Pointcut will match every resource and method of the API. This means that the policy being applied will be executed for every request the HTTP Listener (linked with the API via Auto-Discovery) receives.

* Resource level Pointcut for an API

The policy will be applied to the API, but only when the request method is a GET. You can optionally define a matching regex for the resource for further granularity.

== See Also
