= BAT CLI Reference

The BAT command line interface lets you run tests locally and schedule monitors for continuous API testing. You can schedule tests in the cloud using the CLI-xAPI.  The BAT CLI is integrated with Anypoint Platform.

This reference covers the syntax and key options you can use with the *bat* command. Using the *bat* command, you can debug and run tests, get credentials for scheduling tests, schedule tests, list test schedules, and perform additional operations.

== Commands

* `bat [<file> ... | <option> ...]`
+
When you execute bat without any arguments, BAT reads the YAML in the current directory and runs the specified tests.
You can create a `config` folder and add different configuration files in `config` for the environments, as in this example:
+
----
test-project/
├── bat.yaml
├── tests/
└── config/
    ├── default
    ├── prod
    └── test
----
+
** `<file>` is the relative path to the path and file name. You can run all of the tests that are in your project folder, all of the tests that are in a subfolder of your project folder, or a specific test.

*** `[main|bat].[yaml|yml]`
+
Runs all of the tests in the project folder
*** `~/path/to/folder/` +
Executes the desired folder. BAT searches for and executes the `bat.yaml` and `main.dwl` files.
*** `./folder/file.dwl` +
Executes the desired file. The root of the project is the current folder.
The root of the project is used to resolve imports, and load libraries and files.

** `--bat-version=1.0.51`
+
Executes BAT using the specified version.

** `--config=<name>`
+
Selects a configuration file (from the `config` folder) and registers the result as a global variable.

** `--init`
+
Sets up a basic project folder. The folder contains the following files:
+
----
bat.yaml
tests/
tests/HelloWorld.dwl
config/
config/default.dwl
config/prod.dwl
config/dev.dwl
----
+
Duplicates the functionality of the `bat init` command.

** `--init-folder`
+
Stores the files, exchange.json and main.dwl, generated by creating the monitor in the current directory.

** `--update`
+
Installs the latest BAT CLI.

** `--version`
+
Prints to standard output the version numbers of installed BAT and wrapper. If the latest version is not installed, that version is downloaded.

** `--validate`
+
Validates the file or folder. Also works with `--config` to validate specific configurations.


* `bat grant -g=<MySecretGroupName> -s=<MyAlias1>:<MySecretName1>,...,<MyAliasN>:<MySecretNameN>`
+
Grants BAT access to secrets stored in Secrets Manager for authenticating to the instance of Anypoint Platform when you run tests and when connecting to reporting tools to generate reports on the results of tests. Access grants are stored in the `bat.yaml` file, using one alias for each secret), as in this example of a grant to access one secret:
+
        secrets:
          MyAlias1:
            name: "MySecretName1"
            env: "f5e030d9-72a4-4cca-8c3a-095d7eed755f"
            org: "3c2fe56e-bc73-436f-9759-806841cf9758"
            group: "1a8aca83-71da-433b-a078-a481c8b0a00a"
            secretId: "171d92b8-8f26-4c8e-99af-920c0cf063c5"
            grant: "mETvv9+srNRc1hZ15HBiyNxbgxjS4MDM72pyZ89XtMMrL5kO6p1iwHIw43R6i1Ud2G09VWEr+7Ui+wwHcdy9PU/C3V0RqqVzUKjhj332DaDj7bwLEqP/tipGLq7B0gSmDhdHJUMChLuuv9UhomlwedmOamP6YLI0hsmrpVnxP8ShASR03VQL7GbqCyJ4EVk3/gdnsoxxPi+fO4a9RP4vxu5x4sHbUReDQhoB3xgwWtGyHmgdoOl2KRtl2AOU8CZALUqUvtFOHk9erxHxV9vb11pk+23RM+jtpBd9HFTN7gQ="
+
The grant is encrypted in Base64.
+
** `-g=<MySecretGroupName>`
+
Specifies the name of the group in Secrets Manager in which the secrets are stored. The group must already exist in Secrets Manager.
** `-s=<MyAlias1>:<MySecretName1>,...,<MyAliasN>:<MySecretNameN>`
+
Specifies the alias to associate with the name of each secret that you grant BAT access to. The names must already exists in the group that you grant access to.

* `bat init`
+
Sets up a basic project folder. The folder contains the following files:
+
----
bat.yaml
tests/
tests/HelloWorld.dwl
config/
config/default.dwl
config/prod.dwl
config/dev.dwl
----
+
Duplicates the functionality of the `--init` option of the `bat` command.
* `bat get_token`
+
Returns the token for accessing Anypoint Platform in the credentials file. Requires that you first run `bat login` to generate a profile.

* `bat login --username=<value> [--password=<value>] [--profile=<value>] --host=<value>`
+
** `--host=<value>`
+
The hostname of the instance of Anypoint Platform on which you want to run tests.
** `--password=<value>`
+
The password for the Anypoint Platform username. If you do not specify the password in the `bat login` command, the CLI asks you for the password:
`password for user [username]: <password>`
+
** `--profile=<value>`
+
Specify either of these values:
+
*** The name of a profile for accessing an Anypoint Platform location and retaining the login information between BAT sessions. Using this option eliminates the need to relogin between sessions. Optional.
*** The name of a profile for scheduling an endpoint that can be different from the BAT login profile you used. By default, BAT uses the login profile for scheduling. Optional.
+
** `--username=<value>`
+
An Anypoint Platform username.
+
* `bat worker register`
+
Generates a post with the machine name and creates a dummy target.
+
* `bat target ls list`
+
Lists all the targets information from the profile's organization.
+
* `bat schedule create [--cron="<expression>"]`
+
Creates a scheduler using a cron expression and generates a `.zip` file that includes the tests and all the files. By default, if a cron expression is not entered, tests are scheduled to run every 5 minutes.
+
* `bat schedule endpoint <arbitrary-URL> [--cron="<cron>"] [--name=<suiteName>] [--target=<targetId>] [--new-relic-license-key=<newRelicLicenseKey>] [--slack-webhook=<slackWebHook>] [--sumo-endpoint=<sumoEndpoint>] [--pager-duty-routing-key=<pagerDutyRoutingKey>] [--custom-report-url=<customReportUrl>] [--custom-report-headers=<header1,header2,...,headerN>] [--custom-report-transformation=<pathToDwlFile>][--init-folder]`
+
Create a monitor in Exchange that uses an URL of your choice. Optionally, you can use options to generate a `bat.yaml` with different parameters.
+
** `[--cron="<cron>"]`
+
By default, tests are scheduled to run every 5 minutes. You can change with the cron expression
+
+
** `[--name="<suiteName>"]`
+
Sets the name of the suite
+
+
** `[--target="<targetId>"]` Sets a specific target to the monitor
+
+
** `[--new-relic-license-key="<newRelicLicenseKey>"]`
+
Adds the New Relic report to the `bat.yaml` file.
+
+
** `[--slack-webhook="<slackWebHook>"]`
+
Adds the Slack report to the `bat.yaml` file.
+
+
** `[--sumo-endpoint="<sumoEndpoint>"]`
+
Adds the Sumo Logic report to the `bat.yaml` file.
+
+
** `[--pager-duty-routing-key="<pagerDutyRoutingKey>"]`
+
Adds the pager duty report to the `bat.yaml` file.
+
+
** `[--custom-report-url="<customReportUrl>"] [--custom-report-headers="<header1,header2,...,headerN>"] | [--custom-report-transformation="<pathToDwlFile>"]` Adds the custom report to the `bat.yaml` file and optionally adds the transformation file.
+
+
** `[--init-folder]`
+
Stores generated `exchange.json`, `bat.yaml`, and `main.dwl` files in the current directory.
+
* `bat schedule ls list`
+
Lists all the schedulers information from the profile's organization.
+
* `bat schedule rm | remove <scheduleId>`
+
Deletes a schedule by its ID.


== See Also

* link:/design-center/v/1.0/bat-schedule-test-task[To Schedule a Test]
